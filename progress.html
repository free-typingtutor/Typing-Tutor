<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Typing Tutor â€“ Progress</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
<header class="site-header">
  <h1>Typing Tutor</h1>
  <nav class="nav">
    <a href="index.html">Typing Test</a>
    <a href="practice.html">Practice</a>
    <a href="lessons.html">Lessons</a>
    <a class="active" href="progress.html">Progress</a>
    <a href="about.html">About</a>
  </nav>
  <div class="toggles">
    <button id="themeToggle" class="secondary">ðŸŒ™ Dark</button>
  </div>
</header>

<main class="container">
  <section class="panel">
    <div class="stats-grid">
      <div class="stat"><div class="label">Attempts</div><div id="sAttempts" class="value">0</div></div>
      <div class="stat"><div class="label">Best WPM</div><div id="sBest" class="value">0</div></div>
      <div class="stat"><div class="label">Average WPM</div><div id="sAvg" class="value">0</div></div>
    </div>
    <h3 class="panel-title">WPM History</h3>
    <canvas id="wpmChart" width="900" height="260"></canvas>
  </section>
</main>

<footer class="site-footer">Track your growth over time ðŸ“ˆ</footer>

<script src="util.js"></script>
<script>
  initThemeToggle('themeToggle');

  const s = Storage.getSummary();
  document.getElementById('sAttempts').textContent = s.attempts;
  document.getElementById('sBest').textContent     = s.bestWPM;
  document.getElementById('sAvg').textContent      = s.avgWPM;

  const history = Storage.getHistoryWPM(); // array
  // Simple canvas line chart
  const canvas = document.getElementById('wpmChart');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if (history.length) {
    const pad = 30;
    const w = canvas.width - pad*2;
    const h = canvas.height - pad*2;
    const maxWPM = Math.max(...history, 50);
    // axes
    ctx.strokeStyle = getComputedStyle(document.body).getPropertyValue('--c-border') || '#ccc';
    ctx.beginPath();
    ctx.moveTo(pad, pad);
    ctx.lineTo(pad, pad+h);
    ctx.lineTo(pad+w, pad+h);
    ctx.stroke();

    // line
    ctx.beginPath();
    history.forEach((v,i)=>{
      const x = pad + (w * (i/(Math.max(1,history.length-1))));
      const y = pad + h - (h * (v / maxWPM));
      i===0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
    });
    ctx.lineWidth = 2;
    ctx.strokeStyle = '#3a7afe';
    ctx.stroke();

    // points
    history.forEach((v,i)=>{
      const x = pad + (w * (i/(Math.max(1,history.length-1))));
      const y = pad + h - (h * (v / maxWPM));
      ctx.beginPath();
      ctx.arc(x,y,3,0,Math.PI*2);
      ctx.fillStyle = '#34a853';
      ctx.fill();
    });
  } else {
    ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--c-muted') || '#666';
    ctx.fillText('No history yet. Take a test to populate this chart.', 40, 130);
  }
</script>
</body>
</html>
